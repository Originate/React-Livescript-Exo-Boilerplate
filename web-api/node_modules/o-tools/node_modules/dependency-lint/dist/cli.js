(function() {
  var async, asyncHandlers, docopt, fs, generateConfig, options, packageJson, path, usage;

  async = require('async');

  asyncHandlers = require('async-handlers');

  docopt = require('docopt').docopt;

  fs = require('fs-extra');

  packageJson = require('../package.json');

  path = require('path');

  usage = 'Usage:\n  dependency-lint [--generate-config]\n\nOptions:\n  -h, --help           Show this screen\n  --generate-config    Generate a configuration file\n  -v, --version        Show version';

  options = docopt(usage, {
    version: packageJson.version
  });

  generateConfig = function() {
    var callback, dest, src;
    src = path.join(__dirname, '..', 'config', 'default.yml');
    dest = path.join(process.cwd(), 'dependency-lint.yml');
    callback = function(err) {
      asyncHandlers.exitOnError(err);
      return console.log('Configuration file generated at "dependency-lint.yml"');
    };
    return async.waterfall([
      function(next) {
        return fs.readFile(src, 'utf8', next);
      }, function(defaultConfig, next) {
        var fileContents;
        fileContents = "# See " + packageJson.homepage + "/blob/v" + packageJson.version + "/docs/configuration.md\n# for a detailed explanation of the options\n\n" + defaultConfig;
        return fs.writeFile(dest, fileContents, next);
      }
    ], callback);
  };

  if (options['--generate-config']) {
    generateConfig();
  } else {
    require('./run');
  }

}).call(this);
