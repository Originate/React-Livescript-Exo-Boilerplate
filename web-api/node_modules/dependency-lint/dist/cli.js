(function() {
  var coroutine, docopt, exitWithError, options, packageJson, usage;

  coroutine = require('bluebird').coroutine;

  docopt = require('docopt').docopt;

  exitWithError = require('./util/exit_with_error');

  packageJson = require('../package.json');

  usage = 'Usage:\n  dependency-lint [--auto-correct] [--generate-config]\n\nOptions:\n  --auto-correct       Moves mislabeled modules and removes unused modules\n  -h, --help           Show this screen\n  --generate-config    Generate a configuration file\n  -v, --version        Show version';

  options = docopt(usage, {
    version: packageJson.version
  });

  coroutine(function*() {
    var error, error1, file, fn, fnOptions;
    try {
      file = options['--generate-config'] ? 'generate_config' : 'run';
      fn = require("./" + file);
      fnOptions = {
        autoCorrect: options['--auto-correct']
      };
      return (yield fn(fnOptions));
    } catch (error1) {
      error = error1;
      return exitWithError(error);
    }
  })();

}).call(this);
