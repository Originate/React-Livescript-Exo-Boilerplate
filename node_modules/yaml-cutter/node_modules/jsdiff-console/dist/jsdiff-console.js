// Generated by LiveScript 1.5.0
var ref$, green, grey, red, reset, diff, renderDifferences, getColor;
ref$ = require('chalk'), green = ref$.green, grey = ref$.grey, red = ref$.red, reset = ref$.reset;
diff = require('diff');
renderDifferences = function(differences){
  var part;
  return (function(){
    var i$, ref$, len$, results$ = [];
    for (i$ = 0, len$ = (ref$ = differences).length; i$ < len$; ++i$) {
      part = ref$[i$];
      results$.push(getColor(part)(part.value));
    }
    return results$;
  }()).join('');
};
getColor = function(part){
  switch (false) {
  case !part.added:
    return green;
  case !part.removed:
    return red;
  default:
    return grey;
  }
};
module.exports = function(actual, expected, done){
  var differences;
  switch (false) {
  case !!actual:
    throw new Error("JsDiffConsole: parameter 2 is falsy");
  case !!expected:
    throw new Error("JsDiffConsole: parameter 1 is falsy");
  }
  differences = diff.diffJson(expected, actual);
  if (differences.length === 1) {
    if (done) {
      return done();
    } else {
      return new Promise(function(fulfill, reject){
        return fulfill();
      });
    }
  } else {
    if (done) {
      return done("mismatching records:\n\n" + renderDifferences(differences));
    } else {
      return new Promise(function(fulfill, reject){
        return reject("mismatching records:\n\n" + renderDifferences(differences));
      });
    }
  }
};